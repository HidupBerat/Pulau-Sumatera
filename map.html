<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peta Interaktif Sumatera</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        #map { height: 600px; width: 100%; }
    </style>
</head>
<body>

<h2>Peta Interaktif - Pulau Sumatera</h2>
<div id="map"></div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>

<!-- Leaflet.js -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<script>
    // 🔥 KONFIGURASI FIREBASE (GANTI DENGAN PUNYA KAMU)
    const firebaseConfig = {
        apiKey: "API_KEY_KAMU",
        authDomain: "PROJECT_ID.firebaseapp.com",
        projectId: "PROJECT_ID",
        storageBucket: "PROJECT_ID.appspot.com",
        messagingSenderId: "SENDER_ID",
        appId: "APP_ID"
    };

    // 🔥 Inisialisasi Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // 🗺️ Inisialisasi Peta di Pulau Sumatera
    var map = L.map('map', {
        center: [0, 101], // Koordinat tengah Sumatera
        zoom: 6,
        maxBounds: [[-6, 94], [7, 107]], // Batasi area hanya di Sumatera
        maxBoundsViscosity: 1.0
    });

    // 🌍 Tambahkan Tile Layer (Peta)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // 📌 Fungsi untuk menampilkan semua marker dari Firebase
    function loadMarkers() {
        db.collection("markers").get().then(querySnapshot => {
            querySnapshot.forEach(doc => {
                let data = doc.data();
                let marker = L.marker([data.lat, data.lng]).addTo(map)
                    .bindPopup(data.info);
            });
        }).catch(error => console.error("Gagal memuat marker:", error));
    }

    // 📍 Tambah Marker Baru & Simpan ke Firebase
    function onMapClick(e) {
        var info = prompt("Masukkan informasi untuk lokasi ini:");
        if (info) {
            let newMarker = L.marker(e.latlng).addTo(map)
                .bindPopup(info)
                .openPopup();

            db.collection("markers").add({
                lat: e.latlng.lat,
                lng: e.latlng.lng,
                info: info
            }).then(() => console.log("Marker berhasil disimpan!"))
            .catch(error => console.error("Gagal menyimpan marker:", error));
        }
    }

    // 🔄 Muat marker saat halaman dibuka
    loadMarkers();

    // 🔘 Tambahkan event untuk klik peta
    map.on("click", onMapClick);
</script>

</body>
</html>
